<?php /** * @version		1.3 com_annonces - petites annonces $ * @package		simple_ads_-_petites_annonces * @copyright	Copyright (c) 2011 - All rights reserved. * @license		GNU/GPL * @author		Anthony JULOU * @author mail	ajulou@yahoo.fr * **/defined('_JEXEC') or die('Restricted access'); ?><script type="text/javascript">		function submitbutton( pressbutton ) 		{			var form = document.getElementById('adminForm');			if ( pressbutton != 'annulerSauver' )			{					if ( form.objet2.value.length==0 ) {					alert("<?php echo JText::_( 'ENTER OBJET', true ); ?>");	   				form.objet2.focus();	   				return false;				} 				<?php if ( $this->annonce->showConstructor ) : ?>					else if ( form.constructeur.value.length==0 ) {							alert("<?php echo JText::_( 'ENTER CONSTRUCTOR', true ); ?>");			   				form.constructeur.focus();			   				return false;					} 				<?php endif; ?>								<?php if ( $this->annonce->showYear ) : ?>					else if ( form.annee.value.length==0 ) {						alert("<?php echo JText::_( 'ENTER YEAR', true ); ?>");		   				form.annee.focus();		   				return false;					}				<?php endif; ?>								else if ( form.villeObjet.value.length==0 ) {					alert("<?php echo JText::_( 'ENTER CITY', true ); ?>");	   				form.villeObjet.focus();	   				return false;				} 								<?php if ( $this->annonce->showDimensions ) : ?>					else if ( toTransFloat(form.longueur) == 0 ) {						alert("<?php echo JText::_( 'ENTER LENGTH', true ); ?>");		   				form.longueur.focus();		   				return false;					}					else if ( toTransFloat(form.largeur) == 0 ) {						alert("<?php echo JText::_( 'ENTER WIDTH', true ); ?>");		   				form.largeur.focus();		   				return false;					} 				<?php endif; ?>								else				{					<?php						// JavaScript for extracting editor text						echo $this->editor->save( 'description' );					?>				}			}						form.task.value=pressbutton;			form.submit();			return false;		}		function toTransFloat( input )		{			value = input.value;			if ( value != null && value.length != 0 )				value = value.replace( ',' , '.' );			else 				return false;			input.value = ( isNaN( parseFloat( value ) ) == false ? parseFloat( value ) : "" ); 			return input.value;		}				function supprimerPhoto( photoId )		{			var form = document.getElementById('adminForm');			form.photoSupprId.value=photoId;			form.task.value='effacerPhoto';			form.submit();		}				function changerCategorie()		{			var form = document.getElementById('adminForm');			form.task.value='changerCategorie';			form.submit();		}		</script><div id="editAnnonce" class="editAnnonce">   	<div class="componentheading"><?php echo $this->titrePage ?></div>   	<p><?php echo $this->introductionPage?></p>    <form enctype="multipart/form-data" id="adminForm" action="<?php echo JRoute::_('index.php') ?>" method="post">        <?php if ( $this->annonce->categorie != 0 ) : ?>	        <div>	            <button type="button" class="button" onclick="submitbutton('sauverAnnonce');">	        	    <?php echo JText::_('SAVE') ?>	        	</button>	        	<button type="reset" class="button" onclick="submitbutton('annulerSauver');">	        	    <?php echo JText::_('CANCEL') ?>	        	</button>	        </div>		<?php endif; ?>                       <p class="clear"></p>    	<fieldset class="fieldset">    		<legend><?php echo JText::_('Properties'); ?></legend>        	        	<div>          		<label for="categorie">                  <?php echo JText::_( 'CATEGORY' ).':';?>              	</label>          		<?php                	$html = JHTML::_('select.genericlist', $this->categories, 'categorie','size="1" onchange="javascript:changerCategorie()"', 'value', 'text', $this->annonce->categorie );                	echo $html;           		?>          		<?php if ( $this->annonce->categorie == 0 ) : ?>	          		<button type="button" class="button" onclick="javascript:return changerCategorie()">	        	    	<?php echo JText::_('NEXT') ?>	        		</button>	        	<?php endif; ?>          	</div>        	        	        	<?php if ( $this->annonce->categorie != 0 ) : ?>        	<div>              <label for="date">                  <?php echo JText::_( 'DATE' ).':'; ?>              </label>              <input class="inputbox required" type="text" id="date" name="date" disabled="disabled"  value="<?php echo JHTML::Date( $this->annonce->date, '%d/%m/%Y' ) ?>" size="12" maxlength="12" />      		</div>        	        	<?php if ( $this->annonce->approuved ) : ?>	        	 <div>		              <label for="published">		                  <?php echo JText::_( 'IN LIGNE' ).':'; ?>		              </label>		              <div class="checkbox" id="checkbox">			              <?php			                	echo JHTML::_('select.booleanlist','published','class="inputbox"',$this->annonce->published); 			          		?>			          </div>	         	 </div>        	<?php endif ?>        	          <div>              <label for="objet2">                  <?php echo JText::_( 'objet' ).':'; ?>              </label>              <input class="inputbox required" type="text" id="objet2" name="objet" value="<?php echo $this->escape($this->annonce->objet); ?>" size="40" maxlength="100" />          	  <small class="" title="<?php echo JText::_( 'REQUIRED' ); ?>">          	  		<img src="components/com_annonces/assets/images/icon-16-info.png"/>      		  </small>          </div>          <?php if ( $this->annonce->showConstructor ) : ?>	          <div>	              <label for="constructeur">	                  <?php echo JText::_( 'constructor' ).':'; ?>	              </label>	              <input class="inputbox required" type="text" id="constructeur" name="constructeur" value="<?php echo $this->escape($this->annonce->constructeur); ?>" size="40" maxlength="100" />	              <small class="" title="<?php echo JText::_( 'REQUIRED' ); ?>">          	  			<img src="components/com_annonces/assets/images/icon-16-info.png"/>      		 	  </small>	          </div>	      <?php endif; ?>          <div>              <label for="etatneuf">                  <?php echo JText::_( 'ETAT_NEUF' ).':'; ?>              </label>              <div class="checkbox" id="checkbox">                  <?php	                	echo JHTML::_('select.booleanlist','etatneuf','class="inputbox"',$this->annonce->etatneuf); 	          		?>	           </div>          </div>          <?php if ( $this->annonce->showYear ) : ?>	          <div>	              <label for="annee">	                  <?php echo JText::_( 'YEAR' ).':'; ?>	              </label>	              <input class="inputbox required" type="text" id="annee" name="annee" value="<?php echo $this->escape($this->annonce->annee); ?>" size="6" maxlength="4" />	              <small class="" title="<?php echo JText::_( 'REQUIRED' ); ?>">          	  			<img src="components/com_annonces/assets/images/icon-16-info.png"/>      		 	  </small>	          </div>	      <?php endif; ?>          <div>              <label for="villeObjet">                  <?php echo JText::_( 'city' ).':'; ?>              </label>              <input class="inputbox required" type="text" id="villeObjet" name="villeObjet" value="<?php echo $this->escape($this->annonce->villeObjet); ?>" size="40" maxlength="60" />          </div>          <?php if ( $this->annonce->showDimensions ) : ?>	          <div>	              <label for="longueur">	                  <?php echo JText::_( 'LENGTH' ).':'; ?>	              </label>	              <input class="inputbox required" type="text" id="longueur" name="longueur" value="<?php echo $this->escape($this->annonce->longueur); ?>" size="5" maxlength="10" />	              <?php echo ' ' . $this->parametrage->metric ?>	              <small class="" title="<?php echo JText::_( 'REQUIRED' ); ?>">          	  			<img src="components/com_annonces/assets/images/icon-16-info.png"/>      		 	  </small>	          </div>	          <div>	              <label for="largeur">	                  <?php echo JText::_( 'WIDTH' ).':'; ?>	              </label>	              <input class="inputbox required" type="text" id="largeur" name="largeur" value="<?php echo $this->escape($this->annonce->largeur); ?>" size="5" maxlength="10" />	              <?php echo ' ' . $this->parametrage->metric ?>	              <small class="" title="<?php echo JText::_( 'REQUIRED' ); ?>">          	  			<img src="components/com_annonces/assets/images/icon-16-info.png"/>      		 	  </small>	          </div>          <?php endif; ?>          <?php 					for ($i = 1; $i <= 5; $i++) 					{						$propriete = 'propriete'.$i;						$valeur = $this->annonce->$propriete;												$libelle = "libelle".$i;						$valeurLibelle = $this->annonce->$libelle;												$affiche = strlen( $valeurLibelle );												if ( $affiche > 0 ) : ?>							<div>					              <label for="<?php echo 'propriete'.$i?>">					                  <?php echo $valeurLibelle.':';  ?>					              </label>					              <input class="inputbox required" type="text" id="<?php echo 'propriete'.$i?>" name="<?php echo 'propriete'.$i?>" value="<?php echo $valeur ?>" size="30" maxlength="50" />					        </div>					<?php endif; 					}			  ?>		  <div>              <label for="prix">                  <?php echo JText::_( 'PRICE' ).':'; ?>              </label>              <input class="inputbox required" type="text" id="prix" name="prix" value="<?php echo $this->escape($this->annonce->prix); ?>" size="5" maxlength="10" />              <?php echo ' ' . $this->parametrage->currency ?>          </div>        </fieldset>    	<fieldset>      	  <legend><?php echo JText::_('SELLER'); ?></legend>		  <div>              <label for="vendeurName">                  <?php echo JText::_( 'Name' ).':'; ?>              </label>              <input class="inputbox required" type="text" id="vendeurName" name="objet" value="<?php echo $this->escape($this->annonce->vendeur->name); ?>" size="40" maxlength="60" disabled="disabled" />          </div>          <div>              <label for="telephone">                  <?php echo JText::_( 'Tel' ).':'; ?>              </label>              <input class="inputbox required" type="text" id="telephone" name="telephone" value="<?php echo $this->escape($this->annonce->telephone); ?>" size="15" maxlength="20" />          </div>           <div>              <label for="portable">                  <?php echo JText::_( 'mobile' ).':'; ?>              </label>              <input class="inputbox required" type="text" id="portable" name="portable" value="<?php echo $this->escape($this->annonce->portable); ?>" size="15" maxlength="20" />          </div>        </fieldset>    	<fieldset>      	  <legend><?php echo JText::_('PHOTOS'); ?></legend>      		<?php      		    $j=1;      		    foreach ( $this->tableau_images as $image )				{ 					?>						<div class="img_cont">								<label for="photo<?php echo $j?>"><?php echo JText::_( 'PHOTO' ).' '.$j; ?></label><br/>								<?php if ( $image->existe== true) : ?>									<img src="<?php echo $image->vignetteUrl?>"/><br>									<input type="button" class="button" value="<?php echo JText::_('DELETE')?>" onclick="return supprimerPhoto('<?php echo $j?>')"/> 								<?php else: ?>									<br/>									<input class="inputbox" name="photo<?php echo $j?>" id="photo<?php echo $j?>" type="file" />								<?php endif; ?>							</div>											<?php 					$j++;				}        	?>    	</fieldset>    	<fieldset class="description">      		<legend><?php echo JText::_('DESC_SELLER') ?></legend>      		<?php      			echo $this->editor->display('description', $this->annonce->description, '100%', '400', '70', '15', false );			?>			<?php endif;?>    	</fieldset>    	   		<p class="clear">   			<input type="hidden" name="option" value="com_annonces"/>	    	<input type="hidden" name="id" value="<?php echo $this->annonce->id; ?>" />	    	<input type="hidden" name="referer" value="<?php echo @$_SERVER['HTTP_REFERER']; ?>" />	    	<input type="hidden" name="curimage" value="<?php echo $this->row->datimage; ?>" />	    	<input type="hidden" name="vendeurId" value="<?php echo $this->annonce->vendeur->id; ?>" />	    	<input type="hidden" name="photoSupprId" id="photoSupprId" value=""/>	    	<input type="hidden" name="Itemid" value="<?php echo $this->item->id;?>" />	    	<?php echo JHTML::_( 'form.token' ); ?>	    	<input type="hidden" name="task" id="task" value="" />	    </p>    </form></div><?php//keep session alive while editingJHTML::_('behavior.keepalive');?>